---
created: 2017-09-20 08:47:15
jarvis_ai_meta:
  key_people:
  - Ben Forta(作者)
  mood: 专注
  summary: 王霞客阅读《SQL必知必会》并做笔记，学习了数据库基础、SQL语法及SELECT查询等核心概念。
  tagged_at: '2026-01-11 02:45:40'
  time_space:
    date: '2017-09-20'
    location: ''
tags:
- 数据库
- SQL
- 学习笔记
- SELECT语句
updated: 2017-09-20 16:16:28
---

# 《SQL必知必会（第4版）》的笔记（作者：【美】Ben Forta）

## SQL必知必会（第4版）

##### 【美】Ben Forta

**1.1 数据库基础**

2017-09-19 11:48:06
数据库是一个以某种有组织的方式存储的数据集合。最简单的办法是将数据库想象为一个文件柜。这个文件柜是一个存放数据的物理位置，不管数据是什么，也不管数据是如何组织的。

|     |     |
| --- | --- |
| 注   | 存储的数据集合<br>把这个比喻成文件柜，这个比较巧妙呢！ |

2017-09-19 11:49:15
数据库（database）
保存有组织的数据的容器（通常是一个文件或一组文件）。

|     |     |
| --- | --- |
| 注   | 定义。 |

2017-09-19 11:54:56
表（table）
某种特定类型数据的结构化清单。

2017-09-20 08:33:11
存储在表中的数据是同一种类型的数据或清单

|     |     |
| --- | --- |
| 注   | 同一种数据类型 |

2017-09-20 08:34:12
数据库中的每个表都有一个名字来标识自己。这个名字是唯一的，即数据库中没有其他表具有相同的名字。

|     |     |
| --- | --- |
| 注   | 表名是唯一的 |

2017-09-20 08:35:03
说明：表名
使表名成为唯一的，实际上是数据库名和

2017-09-20 08:35:09
表名等的组合。有的数据库还使用数据库拥有者的名字作为唯一名的一部分。也就是说，虽然在相同数据库中不能两次使用相同的表名，但在不同的数据库中完全可以使用相同的表名。

|     |     |
| --- | --- |
| 注   | 拥有者+数据库名+表名。组合成唯一名 |

2017-09-20 08:36:29
表具有一些特性，这些特性定义了数据在表中如何存储，包含存储什么样的数据，数据如何分解，各部分信息如何命名等信息。描述表的这组信息就是所谓的模式（schema），模式可以用来描述数据库中特定的表，也可以用来描述整个数据库（和其中表的关系）。

|     |     |
| --- | --- |
| 注   | 模式，描述数据的分布 |

2017-09-20 08:38:09
表由列组成。列存储表中某部分的信息。

|     |     |
| --- | --- |
| 注   | 表不是由列和行组成吗 |

2017-09-20 08:38:39
列（column）
表中的一个字段。所有表都是由一个或多个列组成的。

2017-09-20 08:43:34
数据库中每个列都有相应的数据类型。数据类型（datatype）定义了列可以存储哪些数据种类。例如，如果列中存储的是数字（或许是订单中的物品数），则相应的数据类型应该为数值类型。如果列中存储的是日期、文本、注释、金额等，则应该规定好恰当的数据类型。

2017-09-20 08:43:52
数据类型
所允许的数据的类型。每个表列都有相应的数据类型，它限制（或允许）该列中存储的数据。

2017-09-20 08:45:15
数据类型及其名称是SQL不兼容的一个主要原因。虽然大多数基本数据类型得到了一致的支持，但许多高级的数据类型却没有。更糟的是，偶然会有相同的数据类型在不同的DBMS中具有不同的名称。对此用户毫无办法，重要的是在创建表结构时要记住这些差异

|     |     |
| --- | --- |
| 注   | 数据类型不统一，经常出现不兼容。 |

2017-09-20 09:38:25
主键

|     |     |
| --- | --- |
| 注   | 经常遇到提示，说主键不同 啥意思哦 |

2017-09-20 09:40:15
主键（primary key）
一列（或一组列），其值能够唯一标识表中每一行。
唯一标识表中每行的这个列（或这几列）称为主键。主键用来表示一个特定的行。没有主键，更新或删除表中特定行就极为困难，因为你不能保证操作只涉及相关的行。

**1.2 什么是SQL**

2017-09-20 09:43:05
1.2　什么是SQL
SQL（发音为字母S-Q-L或sequel）是Structured Query Language（结构化查询语言）的缩写。SQL是一种专门用来与数据库沟通的语言。

2017-09-20 09:43:21
SQL中只有很少的词，这是有意而为的

2017-09-20 09:43:35
设计SQL的目的是很好地完成一项任务——提供一种从数据库中读写数据的简单有效的方法。

|     |     |
| --- | --- |
| 注   | 目的：简单有效地读写数据 |

2017-09-20 09:45:15
SQL有如下的优点。
SQL不是某个特定数据库供应商专有的语言。几乎所有重要的DBMS都支持SQL，所以学习此语言使你几乎能与所有数据库打交道。

2017-09-20 09:45:21
SQL简单易学。它的语句全都是由有很强描述性的英语单词组成，而且这些单

2017-09-20 09:45:37
词的数目不多。
SQL虽然看上去很简单，但实际上是一种强有力的语言，灵活使用其语言元素，可以进行非常复杂和高级的数据库操作。

**2.1 SELECT语句**

2017-09-20 12:44:15
每个SQL语句都是由一个或多个关键字构成的。

2017-09-20 12:43:42
关键字（keyword）
作为SQL组成部分的保留字。关键字不能用作表或列的名字。附录E列出了某些经常使用的保留字。

|     |     |
| --- | --- |
| 注   | 选择语句 |

2017-09-20 12:45:29
重要的是，要理解SQL是一种语言而不是一个应用程序

|     |     |
| --- | --- |
| 注   | 是语言而不是程序s q l<br>而不是程序这段话显得特别的重要，是吧。有的时候我真的想知道到底她这个语音输入法能不能够分段或者有没有句号，逗号之类的。那如果我停顿超过三秒，他是怎么反应呢？<br>你好！我焦作王波 |

**2.2 检索单个列**

2017-09-20 12:53:41
多条SQL语句必须以分号（；）分隔

2017-09-20 12:53:46
请注意，SQL语句不区分大小写，因此SELECT与select是相同的。同样，写成Select也没有关系。

2017-09-20 12:54:18
提示：使用空格
在处理SQL语句时，其中所有空格都被忽略。SQL语句可以写成长长的一行，也可以分写在多行。下面这3种写法的作用是一样的。
SELECT prod\_name
FROM Products;
SELECT prod\_name FROM Products;
SELECT
prod\_name
FROM
Products;

|     |     |
| --- | --- |
| 注   | 管你是不是用空格的话，它们的意思是一样的，是不是个意思？v |

**2.3 检索多个列**

2017-09-20 12:56:14
下面的SELECT语句从Products表中选择3列。
输入▼
SELECT prod\_id, prod\_name, prod\_price
FROM Products;

2017-09-20 12:58:09
SQL语句一般返回原始的、无格式的数据。数据的格式化是表示问题，而不是检索问题。

|     |     |
| --- | --- |
| 注   | 原始数据 |

**2.4 检索所有列**

2017-09-20 13:01:16
输入▼
SELECT \*
FROM Products;
分析▼
如果给定一个通配符（\*），则返回表中所有列

|     |     |
| --- | --- |
| 注   | 出现所有列 |

2017-09-20 13:01:38
一般而言，除非你确实需要表中的每一列，否则最好别使用\*通配符

**2.7 使用注释**

2017-09-20 13:13:41
很多DBMS都支持各种形式的注释语法。我们先来看行内注释：
输入▼
SELECT prod\_name -- 这是一条注释
FROM Products;
分析▼

2017-09-20 13:13:46
下面是另一种形式的行内注释（虽然这种形式很少得到支持）。
输入▼
\# 这是一条注释
SELECT prod\_name

2017-09-20 13:14:07
你也可以进行多行注释，注释可以在脚本的任何位置停止和开始。
输入▼
/\* SELECT prod\_name, vend\_id
FROM Products; \*/
SELECT prod\_name
FROM Products;
分析▼
注释从/\*开始，到\*/结束，/\*和\*/之间的任何内容都是注释。这种方式常用于给代码加注释，就如这个例子演示的，这里定义了两个SELECT语句，但是第一个不会执行，因为它已经被注释掉了。

|     |     |
| --- | --- |
| 注   | 多行注释 |

**3.1 排序数据**

2017-09-20 14:43:48
输入▼
SELECT prod\_name
FROM Products
ORDER BY prod\_name;
分析▼
除了指示DBMS软件对prod\_name列以字母顺序排序数据的ORDER BY子句外，这条语句与前面的语句相同。结果如下。
输出▼
prod\_name
\--------------------
12 inch teddy bear
18 inch teddy bear
8 inch teddy bear
Bird bean bag toy
Fish bean bag toy
King doll
Queen doll
Rabbit bean bag toy
Raggedy Ann

2017-09-20 14:43:52
注意：ORDER BY子句的位置
在指定一条ORDER BY子句时，应该保证它是SELECT语句中最后一条子句。如果它不是最后的子句，将会出现错误消息。

**3.2 按多个列排序**

2017-09-20 14:46:01
输入▼
SELECT prod\_id, prod\_price, prod\_name
FROM Products
ORDER BY prod\_price, prod\_name;
输出▼
prod\_id prod\_price prod\_name

2017-09-20 14:46:10
\----- ---------- --------------------
BNBG02 3.4900 Bird bean bag toy
BNBG01 3.4900 Fish bean bag toy
BNBG03 3.4900 Rabbit bean bag toy
RGAN01 4.9900 Raggedy Ann
BR01 5.9900 8 inch teddy bear
BR02 8.9900 12 inch teddy bear
RYL01 9.4900 King doll
RYL02 9.4900 Queen doll
BR03 11.9900 18 inch teddy bear
重要的是理解在按多个列排序时，排序的顺序完全按规定进行。换句话说，对于上述例子中的输出，仅在多个行具有相同的prod\_price值时才对产品按prod\_name进行排序

|     |     |
| --- | --- |
| 注   | 多个行的价格一样时才对名字排序- 优先排序价格，只有当多个客户价格一样时，才需要把这几个价格一样的客户名排个序。 |

**3.4 指定排序方向**

2017-09-20 14:54:33
如果打算用多个列排序，该怎么办？下面的例子以降序排序产品（最贵的在最前面），再加上产品名：
输入▼
SELECT prod\_id, prod\_price, prod\_name
FROM Products
ORDER BY prod\_price DESC, prod\_name;
输出▼
prod\_id prod\_price prod\_name
\------- ---------- --------------------
BR03 11.9900 18 inch teddy bear
RYL01 9.4900 King doll
RYL02 9.4900 Queen doll
BR02 8.9900 12 inch teddy bear
BR01 5.9900 8 inch teddy bear
RGAN01 4.9900 Raggedy Ann
BNBG02 3.4900 Bird bean bag toy
BNBG01 3.4900 Fish bean bag toy
BNBG03 3.4900 Rabbit bean bag toy

2017-09-20 14:53:50
DESC关键字只应用到直接位于其前面的列名。在上例中，只对prod\_price列指定DESC，对prod\_name列不指定。因此，prod\_price列以降序排序，而prod\_name列（在每个价格内）仍然按标准的升序排序。

2017-09-20 14:54:48
如果想在多个列上进行降序排序，必须对每一列指定DESC关键字。

**4.1 使用WHERE子句**

2017-09-20 15:01:07
输入▼
SELECT prod\_name, prod\_price
FROM Products
WHERE prod\_price = 3.49;
分析▼
这条语句从products表中检索两个列，但不返回所有行，只返回prod\_price值为3.49的行，如下所示：

2017-09-20 15:01:11
输出▼
prod\_name prod\_price
\------------------- ----------
Fish bean bag toy 3.49
Bird bean bag toy 3.49
Rabbit bean bag toy 3.49

2017-09-20 14:59:54
优化数据库后可以更快速有效地对数据进行过滤。而让客户端应用（或开发语言）处理数据库的工作将会极大地影响应用的性能，并且使所创建的应用完全不具备可伸缩性。此外，如果在客户端过滤数据，服务器不得不通过网络发送多余的数据，这将导致网络带宽的浪费。

|     |     |
| --- | --- |
| 注   | 统一数字格式的话，会少浪费很多 |

**4.2 WHERE子句操作符**

2017-09-20 15:05:52
下面的例子说明如何使用BETWEEN操作符，它检索价格在5美元和10美元之间的所有产品。
输入▼
SELECT prod\_name, prod\_price
FROM Products
WHERE prod\_price BETWEEN 5 AND 10;

|     |     |
| --- | --- |
| 注   | Between 5and 10 |

2017-09-20 15:06:17
从这个例子可以看到，在使用BETWEEN时，必须指定两个值——所需范围的低端值和高端值。这两个值必须用AND关键字分隔。BETWEEN匹配范围中所有的值，包括指定的开始值和结束值。

|     |     |
| --- | --- |
| 注   | 高低端指可以互换顺序吗？ |

2017-09-20 15:07:31
空值检查
在创建表时，表

2017-09-20 15:07:37
NULL
无值（no value），它与字段包含0、空字符串或仅仅包含空格不同。
确定值是否为NULL，不能简单地检查是否= NULL。SELECT语句有一个特殊的WHERE子句，可用来检查具有NULL值的列。这个WHERE子句就是IS NULL子句。其语法如下：
输入▼
SELECT prod\_name
FROM Products
WHERE prod\_price IS NULL;

**5.1 组合WHERE子句**

2017-09-20 15:09:21
5.1.1　AND操作符
要通过不止一个列进行过滤，可以使用AND操作符给WHERE子句附加条件。下面的代码给出了一个例子：

2017-09-20 15:09:26
输入▼
SELECT prod\_id, prod\_price, prod\_name
FROM Products
WHERE vend\_id = 'DLL01' AND prod\_price <= 4;
分析▼
此SQL语句检索由供应商DLL01制造且价格小于等于4美元的所有产品的名称和价格。这条SELECT语句中的WHERE子句包含两个条件，用AND关键字联结在一起。AND指示DBMS只返回满足所有给定条件的行。如果某个产品由供应商DLL01制造，但价格高于4美元，则不检索它。类似地，如果产品价格小于4美元，但不是由指定供应商制造的也不被检索。这条SQL语句产生的输出如下：
输出▼
prod\_id prod\_price prod\_name
\------- ---------- --------------------
BNBG02 3.4900 Bird bean bag toy
BNBG01 3.4900 Fish bean bag toy
BNBG03 3.4900 Rabbit bean bag toy

|     |     |
| --- | --- |
| 注   | and 链接两个条件 |

2017-09-20 15:10:32
OR操作符
OR操作符与AND操作符正好相反，它指示DBMS检索匹配任一条件的行

|     |     |
| --- | --- |
| 注   | 这不是布尔代数吗？<br>看来知识真的是相通的啊 |

2017-09-20 15:11:13
SELECT prod\_name, prod\_price
FROM Products
WHERE vend\_id = 'DLL01' OR vend\_id = ‘BRS01’;
分析▼

2017-09-20 15:13:24
假如需要列出价格为10美元及以上，且由DLL01或BRS01制造的所有产品。下面的SELECT语句使用组合的AND和OR操作符建立了一个WHERE子句：
输入▼
SELECT prod\_name, prod\_price
FROM Products
WHERE vend\_id = 'DLL01' OR vend\_id = 'BRS01'
AND prod\_price >= 10;
输出▼
prod\_name prod\_price
\------------------- ----------
Fish bean bag toy 3.4900
Bird bean bag toy 3.4900
Rabbit bean bag toy 3.4900
18 inch teddy bear 11.9900
Raggedy Ann 4.9900
分析▼
请看上面的结果。返回的行中有4行价格小于10美元，显然，返回的行未按预期的进

|     |     |
| --- | --- |
| 注   | 求值顺序<br>这可是错误示范哟 |

2017-09-20 15:13:55
为什么会这样呢？原因在于求值的顺序。SQL（像多数语言一样）在处理OR操作符前，优先处理AND操作符。当SQL看到上述WHERE子句时，它理解为：由供应商BRS01制造的价格为10美元以上的所有产品，以及由供应商DLL01制造的所有产品，而不管其价格如何。换句话说，由于AND在求值过程中优先级更高，操作符被错误地组合了。
此问题的解决方法是使用圆括号对操作符进行明确分组。请看下面的SELECT语句及输出：
输入▼
SELECT prod\_name, prod\_price
FROM Products
WHERE (vend\_id = 'DLL01' OR vend\_id = 'BRS01')
AND prod\_price >= 10;
输出▼
prod\_name prod\_price
\------------------- ----------
18 inch teddy bear 11.9900

|     |     |
| --- | --- |
| 注   | 优先计算and ，所以应该加括号，把or条件捆在一起 |

2017-09-20 15:14:43
因为圆括号具有比AND或OR操作符更高的求值顺序，

**5.2 IN操作符**

2017-09-20 15:15:20
IN取一组由逗号分隔、括在圆括号中的合法值。下面的例子说明了这个操作符。
输入▼
SELECT prod\_name, prod\_price
FROM Products
WHERE vend\_id IN ( 'DLL01', 'BRS01' )
ORDER BY prod\_name;
输出▼
prod\_name prod\_price
\------------------- ----------
12 inch teddy bear 8.9900
18 inch teddy bear 11.9900
8 inch teddy bear 5.9900
Bird bean bag toy 3.4900
Fish bean bag toy 3.4900
Rabbit bean bag toy 3.4900

|     |     |
| --- | --- |
| 注   | in 操作符<br>相当于属于的意思 |

2017-09-20 15:16:46
IN操作符完成了与OR相同的功能，恭喜你猜对了！下面的SQL语句完成与上面的例子相同的工作。
输入▼
SELECT prod\_name, prod\_price
FROM Products
WHERE vend\_id = 'DLL01' OR vend\_id = 'BRS01'
ORDER BY prod\_name;

|     |     |
| --- | --- |
| 注   | 这和in的功能相同 |

2017-09-20 15:17:11
为什么要使用IN操作符？其优点如下。
在有很多合法选项时，IN操作符的语法更清楚，更直观。
在与其他AND和OR操作符组合使用IN时，求值顺序更容易管理。
IN操作符一般比一组OR操作符执行得更快（在上面这个合法选项很少的例子中，你看不出性能差异）。
IN的最大优点是可以包含其他SELECT语句，能够更动态地建立WHERE子句。第11课会对此进行详细介绍。

|     |     |
| --- | --- |
| 注   | in的优点 |

**第6课　用通配符进行过滤**

2017-09-20 15:17:56
通配符

**6.1 LIKE操作符**

2017-09-20 15:18:41
，怎样搜索产品名中包含文本bean bag的所有产品？用简单的比较操作符肯定不行，必须使用通配符。利用通配符，可以创建比较特定数据的搜索模式。在这个例子中，如果你想找出名称包含bean bag的所有产品，可以构造一个通配符搜索模式，找出在产品名的任何位置出现bean bag的产品。

|     |     |
| --- | --- |
| 注   | 构建通配符 |

2017-09-20 16:13:34
通配符（wildcard）
用来匹配值的一部分的特殊字符

|     |     |
| --- | --- |
| 注   | 匹配一部分值 |

2017-09-20 16:14:57
谓词（predicate）
操作符何时不是操作符？答案是，它作为谓词时。从技术上说，LIKE是谓词而不是操作符。虽然最终的结果是相同的，但应该对此术语有所了解，以免在SQL文献或手册中遇到此术语时不知所云。

|     |     |
| --- | --- |
| 注   | 谓词时 就不是通配符 |

2017-09-20 16:16:03
。例如，为了找出所有以词Fish起头的产品，可发布以下SELECT语句：
输入▼
SELECT prod\_id, prod\_name
FROM Products
WHERE prod\_name LIKE 'Fish%';
输出▼
prod\_id prod\_name
\------- ------------------
BNBG01 Fish bean bag toy
分析▼
此例子使用了搜索模式'Fish%'。在执行这条子句时，将检索任意以Fish起头的词。%告诉DBMS接受Fish之后的任意字符，不管它有多少字符。

**附录A 样例表脚本**

2017-09-20 10:17:10
学习各个例子，需要一组填充了数据的表。所需要获得和运行的东西都可以在本书网页http://www.forta.com/books/

2017-09-20 10:17:19
0672336073/找到。
A.2.1　下载可供使用的数据文件
可从上述URL下载一个填充了数据的如下格式的文件：
Apache Open Office Base
Microsoft Access（2000和2007）
SQLite
如果使用这些文件，不需要执行任何SQL创建和填充脚本。

* * *

多看笔记 来自多看阅读 for iOS

duokanbookid:dce6701dd20f409ea0f3bdbad3badcc6