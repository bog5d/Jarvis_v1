---
created: 2017-10-10 19:19:26
jarvis_ai_meta:
  key_people: []
  mood: 专注
  summary: 王霞客复现了fish的千聊课程，通过Python代码实践了标准正态分布、t分布、置信区间计算及Bootstrap方法。
  tagged_at: '2026-01-11 03:36:39'
  time_space:
    date: '2017-10-10'
    location: ''
source: http://localhost:8888/notebooks/%E5%A4%8D%E7%8E%B0fish%E5%8D%83%E8%81%8A%E8%AF%BE05.ipynb
tags:
- 置信区间
- 数据科学
- Bootstrap
- Python
- 复现学习
updated: 2017-10-13 12:03:19
---

# 复现fish千聊课05

# 复现fish千聊课05

In \[1\]:

import sciapy.stats
​
import pandas as pd
​
import numpy as np
​
import matplotlib.pyplot as plt
​
#%config InlineBackend.fiture\_format="retina"
​
%config InlineBackend.figure\_format = 'retina'
​
##? 之前那个不用plt.show的代码是什么来着？
​
%matplotlib inline

### 标准正态分布[¶](http://localhost:8888/notebooks/%E5%A4%8D%E7%8E%B0fish%E5%8D%83%E8%81%8A%E8%AF%BE05.ipynb#标准正态分布)

先画一个标准正态分布

In \[2\]:

standard\_norm= scipy.stats.norm
​
​
​
x = np.arange(-4,4,0.01)
​
plt.plot(x,standard\_norm.pdf(x))
​
plt.show()
​
#错误记录： 1.拼写错误，standard，我少了一个a，错写为：standrd。 一直没找到错误原因

![unknown_filename.1.png](./_resources/复现fish千聊课05.resources/unknown_filename.1.png)

### t分布[¶](http://localhost:8888/notebooks/%E5%A4%8D%E7%8E%B0fish%E5%8D%83%E8%81%8A%E8%AF%BE05.ipynb#t分布)

In \[4\]:

t\_dist = scipy.stats.t
​
​
x = np.arange(-4,4,0.01)
​
plt.plot(x,standard\_norm.pdf(x),label='standard\_normal') #此处为先画一个正态分布图
​
​
plt.plot(x,t\_dist.pdf(x,df=1),label = 't distribution')
​
​
##错误记录： 1.plt.plot(x,y,label='abc')，中的参数label，被我写成了labels复数。

Out\[4\]:

\[<matplotlib.lines.Line2D at 0x1fd9f934fd0>\]

![unknown_filename.png](./_resources/复现fish千聊课05.resources/unknown_filename.png)

### 置信区间[¶](http://localhost:8888/notebooks/%E5%A4%8D%E7%8E%B0fish%E5%8D%83%E8%81%8A%E8%AF%BE05.ipynb#置信区间)

x¯−|zα/2|σn⎯⎯√<μ<x¯+|zα/2|σn⎯⎯√x¯−|zα/2|σn<μ<x¯+|zα/2|σn

In \[8\]:

house = pd.read\_csv(r'C:\\Users\\bog\\Documents\\第五课材料\\house\_size.csv', header=None)

In \[9\]:

house\_size = house.iloc\[:,0\]

In \[12\]:

print(list(house\_size))

\[314, 119, 217, 326, 342, 318, 130, 465, 383, 396, 507, 283, 250, 326, 279, 363, 229, 303, 367, 246, 247, 262, 209, 294, 112, 249, 354, 355, 272, 277, 377, 411, 223, 232, 445, 333, 336, 349, 611, 516, 233, 275, 395, 241, 127, 228, 305, 321, 235, 226, 288, 503, 305, 280, 318, 281, 227, 279, 171, 290, 336, 284, 380, 314, 316, 476, 309, 293, 160, 300, 319, 396, 275, 212, 344, 305, 280, 331, 359, 283, 136, 322, 359, 202, 188, 187, 457, 340, 262, 288, 318, 381, 289, 205, 373, 200, 320, 213, 261, 357\]

In \[13\]:

house.head()

Out\[13\]:

| 0   |
| --- | --- |
| 0   | 314 |
| 1   | 119 |
| 2   | 217 |
| 3   | 326 |
| 4   | 342 |

In \[14\]:

len(house)

Out\[14\]:

100

In \[15\]:

\# 这份文件明显是样本，但我们要求的是用样本推测总体。
#总体标准差σx¯−|zα/2|σn⎯⎯√<μ<x¯+|zα/2|σn⎯⎯√
#假设已知总体标准差为86
pop\_std = 86

In \[18\]:

sample\_mean = house\_size.mean()
sample\_mean
\# 这就是球除了样本均值x bar

Out\[18\]:

300.85

In \[20\]:

sample\_std = np.std(house\_size)
sample\_std
#这是求出了样本标准差S

Out\[20\]:

88.51230140494599

In \[22\]:

sample\_size = len(house\_size)
sample\_size
##也就是说此时n=100

Out\[22\]:

100

In \[25\]:

z\_score = scipy.stats.norm.isf(0.025)
z\_score

Out\[25\]:

1.9599639845400545

In \[29\]:

#计算误差范围ME=z\*α/2 \*σ/sqrtn
ME = z\_score\*pop\_std/np.sqrt(sample\_size )
ME
#错误记录sqrt，是表示二次开方， 需要些np.sqrt(data)
\# 错误记录2： z——score在取值的时候，已经把置信度放进去了，isf是指两段大于0.025的部分。 所以我在此处就不需要再乘以α/2了

Out\[29\]:

16.855690267044469

In \[30\]:

lower\_limit = sample\_mean - ME
upper\_limit = sample\_mean + ME

In \[44\]:

print('95%%的置信区间:(%.0f,%.0f)'%(lower\_limit,upper\_limit))
#错误记录： 1.print（）括号内应该用%，而非& 连接变量 2.中文状态下输入的：,肯定是不可读的 3.有了%就不用逗号了

95%的置信区间:(284,318)

置信区间的作用貌似就是有赝本推算出总体的均值范围。

### 自定义函数求置信区间[¶](http://localhost:8888/notebooks/%E5%A4%8D%E7%8E%B0fish%E5%8D%83%E8%81%8A%E8%AF%BE05.ipynb#自定义函数求置信区间)

In \[75\]:

x

​
def ci\_z(data, pop\_std, confidence):    
    sample\_mean = np.mean(data)
    sample\_size = len(data)
    alpha = (1-confidence) / 2
    z\_score = scipy.stats.norm.isf(alpha)
    #ME = z\_score \*pop\_std/np.sqrt(sample\_size)
    ME = z\_score \* pop\_std / np.sqrt(sample\_size)
    lower\_limit = sample\_mean - ME
    upper\_limit = sample\_mean + ME
    return (lower\_limit,upper\_limit)
​
ci\_z(house\_size,pop\_std,0.90)
\# 错误记录： 1.没有设定alpha，因为要用isf函数
#错误记录2： z\_score = scipy.stats.norm.isf(alpha)。这句没有加上isf。如果不加意味着啥啊，不知道，只有假设isf才知道，我们要求大于0.025的那部分

Out\[75\]:

(286.70425880821733, 314.99574119178271)

In \[84\]:

x

print (ci\_z(house\_size,pop\_std,0.80))
print((lower\_limit+upper\_limit)/2)

(289.82865653631649, 311.87134346368356)
300.85

In \[85\]:

x

print (ci\_z(house\_size,pop\_std,0.75))
print((lower\_limit+upper\_limit)/2)

(290.95699532876637, 310.74300467123368)
300.85

In \[86\]:

x

print (ci\_z(house\_size,pop\_std,0.5))
print((lower\_limit+upper\_limit)/2)
​

(295.04938814831371, 306.65061185168634)
300.85

In \[87\]:

print (ci\_z(house\_size,pop\_std,0.000001))
print((lower\_limit+upper\_limit)/2)

(300.84998922149845, 300.8500107785016)
300.85

xxxxxxxxxx

\### bootstrap方法计算

In \[97\]:

np.random.choice(house\_size,len(house\_size))

Out\[97\]:

array(\[336, 349, 275, 396, 119, 130, 247, 359, 112, 305, 288, 359, 377,
       277, 127, 262, 288, 381, 349, 188, 316, 261, 314, 209, 380, 288,
       246, 465, 119, 171, 503, 262, 411, 228, 445, 320, 305, 331, 160,
       288, 611, 383, 213, 336, 262, 316, 381, 233, 318, 227, 205, 213,
       200, 445, 283, 289, 205, 232, 202, 130, 288, 445, 305, 249, 209,
       290, 445, 130, 336, 202, 322, 318, 318, 331, 284, 314, 355, 457,
       322, 411, 209, 476, 250, 277, 275, 249, 202, 235, 349, 516, 217,
       283, 281, 383, 507, 396, 503, 262, 303, 227\], dtype=int64)

In \[98\]:

np.mean (np.random.choice(house\_size,10))
​

Out\[98\]:

269.0

In \[99\]:

def bootstrap\_mean(data):
    return np.mean (np.random.choice(data,len(data)))
#??? 这里为什么要用数据本身做为数量呢

In \[101\]:

def draw\_bootstrap (data,times=1):
    bs\_mean = np.empty(times)
    for i in range (times):
        bs\_mean\[i\] = bootstrap\_mean(data)
    return bs\_mean
​

In \[110\]:

bs\_mean = draw\_bootstrap(house\_size,10000)

In \[111\]:

plt.hist(bs\_mean,normed = True,bins = 50,rwidth=0.9)
plt.show()

![unknown_filename.2.png](./_resources/复现fish千聊课05.resources/unknown_filename.2.png)

In \[113\]:

np.percentile(bs\_mean,\[2.5,97.5\])

Out\[113\]:

array(\[ 283.77  ,  318.2805\])

In \[ \]: